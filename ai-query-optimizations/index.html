<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>AI assisted workflow for Django query optimizations - Mitchell Harle</title><meta name="gridsome:hash" content="be4ce0c63ceb5cbc26b02c0c477ed144fd2f7de3"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="keywords" content="Gridsome,Vue,Tailwind,Tailwind CSS,JavaScript,HTML,CSS,Vue.js,VueJS,Portfolio,Python,React Native,Software Engineer,Developer"><meta data-vue-tag="ssr" name="description" content="Personal website for founder and software engineer Mitchell Harle"><meta data-vue-tag="ssr" name="author" content="Mitchell Harle"><meta data-vue-tag="ssr" data-key="description" name="description" content="Personal website for software engineer Mitchell Harle"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.2447ca9569e5865ec93953b08152fea8.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito+Sans:400,700"><link rel="preload" href="/assets/css/0.styles.cc9a7f61.css" as="style"><link rel="preload" href="/assets/js/app.af93443e.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.09d095cc.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.453d7096.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.9f001bab.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.2adec468.js"><link rel="prefetch" href="/assets/js/page--src--templates--tag-vue.7f715058.js"><link rel="stylesheet" href="/assets/css/0.styles.cc9a7f61.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" class="content-wrapper bg-background-primary font-sans text-copy-primary leading-normal flex flex-col min-h-screen"><header class="border-t-14 border-green-700"><nav class="container mx-auto flex flex-wrap justify-between items-center py-8"><div></div><div class="block lg:hidden"><button class="flex items-center px-3 py-2 border rounded border-gray-500 hover:text-gray-600 hover:border-gray-600"><svg viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg" class="current-color h-3 w-3"><path d="M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z" fill="gray"></path></svg></button></div><ul class="uppercase tracking-wide font-bold w-full block flex-grow lg:flex lg:flex-initial lg:w-auto items-center mt-8 lg:mt-0 hidden"><li class="mr-8 mb-6 lg:mb-0"><a href="#" class="text-copy-primary hover:text-gray-600"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"></path></svg></a></li><li class="mr-8 mb-6 lg:mb-0"><a href="/" class="text-copy-primary hover:text-gray-600">Home</a></li><li class="mr-8 mb-6 lg:mb-0"><a href="/#tools" class="text-copy-primary hover:text-gray-600">Tools</a></li><li class="mr-8 mb-6 lg:mb-0"><a href="/#projects" class="text-copy-primary hover:text-gray-600">Projects</a></li><li class="mr-8 mb-6 lg:mb-0"><a href="/#about" class="text-copy-primary hover:text-gray-600">About</a></li><li class="mr-8 mb-6 lg:mb-0"><a href="/blog" class="text-copy-primary hover:text-gray-600">Blog</a></li><li class="mr-8 mb-6 lg:mb-0"><div class="relative" data-v-94ece32a><div data-v-3ae9f24e data-v-94ece32a></div><div class="relative w-80" data-v-94ece32a><input type="text" placeholder="Search" value="" class="bg-background-form border border-gray-500 rounded-full px-4 pl-10 py-2 outline-none focus:border-green-500 w-60 md:w-80 lg:w-80" data-v-94ece32a><div class="absolute top-0 ml-3" style="top:10px" data-v-94ece32a><svg fill="currentColor" viewBox="0 0 24 24" width="24" height="24" class="text-gray-500 h-5 w-5" data-v-94ece32a><path d="M16.32 14.9l5.39 5.4a1 1 0 0 1-1.42 1.4l-5.38-5.38a8 8 0 1 1 1.41-1.41zM10 16a6 6 0 1 0 0-12 6 6 0 0 0 0 12z" class="heroicon-ui" data-v-94ece32a></path></svg></div><!----></div><!----></div></li></ul><div></div></nav></header><div class="flex-grow"><div class="container-inner mx-auto my-16"><h1 class="text-4xl font-bold leading-tight">AI assisted workflow for Django query optimizations</h1><div class="text-xl text-gray-600 mb-4">August 3, 2025</div><div class="flex flex-wrap mb-4 text-sm"><a href="/tag/Copilot/" class="bg-gray-300 rounded-full mb-4 px-4 py-2 mr-4 hover:bg-green-300 whitespace-no-wrap">
        Copilot
      </a><a href="/tag/Django/" class="bg-gray-300 rounded-full mb-4 px-4 py-2 mr-4 hover:bg-green-300 whitespace-no-wrap">
        Django
      </a><a href="/tag/Django-silk/" class="bg-gray-300 rounded-full mb-4 px-4 py-2 mr-4 hover:bg-green-300 whitespace-no-wrap">
        Django-silk
      </a><a href="/tag/Playwright/" class="bg-gray-300 rounded-full mb-4 px-4 py-2 mr-4 hover:bg-green-300 whitespace-no-wrap">
        Playwright
      </a><a href="/tag/AI/" class="bg-gray-300 rounded-full mb-4 px-4 py-2 mr-4 hover:bg-green-300 whitespace-no-wrap">
        AI
      </a><a href="/tag/LLMs/" class="bg-gray-300 rounded-full mb-4 px-4 py-2 mr-4 hover:bg-green-300 whitespace-no-wrap">
        LLMs
      </a></div><div class="markdown-body mb-8"><p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 841 596' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-21cf64648e150f10b1f707433b5a4193'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-21cf64648e150f10b1f707433b5a4193)' width='841' height='596' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAtAEADASIAAhEBAxEB/8QAGgAAAgMBAQAAAAAAAAAAAAAAAgQAAQMFB//EADQQAAIBAwIDBQYEBwAAAAAAAAECAwAEERIhExQxBSJxkaEjQVFhktFSU2OBFTJDRGLw8f/EABUBAQEAAAAAAAAAAAAAAAAAAAAB/8QAFBEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEQMRAD8A8AtSsiYPIJpwMy5BNGHTc6OzdweoP3orZ7sxqGkuUjAAXTEWGP8AhrVpLgS9y6uyuNmNucn9qDBdJBAHZ23xHX1q1ZevD7O39xU7etXKk0yKs0l0yDcZgO1LvaMFHDSdj8DERRW%2bVIGE7OG34T8fGsblAQu9qMbex2z41kLac9IJT7v5D9qnLTn%2bhL9B%2b1EBoH4hU0Y31Cj5Wfb2Eu/TuHf0quBIoLNHIADvlTgf7tQNW93KY1jM0MaqMAOmc%2bQNbSXcgfRzdmQvRwhx4dKYVSLBOFdziQw7KbiLSNtxjOobbY60pO1/ChkkulI6d2dWO/yBzQXzshYlrm1wf0zgeAxQtfyxLlJrds42WPf1FL8/dn%2b4l6561Y7QvASRcygnqc0Gbzyu5YyOCTnutgftQ8WX82T6zQu7O7O5LMxySffQ0GnFk/Mk%2bs1YaRsDW5ycadROayq0JV1Kkgg7EUHW7PhCwZaG3kZgGUtPCMeIbJHpTM95b2sKxPZxktvlGgfx3Vdq59g8KwSl4FdxjBIUgeamn35QIGFqAc4OyfP/AA%2bVAnNfWZRuFZ6XxhdQjIHiAm9KNdsUK8K2APvEKg%2beK699dRxW5MFrCCcDvxo2B9I3%2bdc7%2bIycbicvZaumOXXHlQI1Kca%2bdmLG3s8n9AUq7anLEKMnoowPKgGoOo8alQdR40H/2Q==' /%3e%3c/svg%3e" width="841" alt="Copilot workflow" data-srcset="/assets/static/copilot-screenshot.82a2fbd.34af4401cab333fbfbe74c40f515e559.jpeg 480w, /assets/static/copilot-screenshot.e9949b5.34af4401cab333fbfbe74c40f515e559.jpeg 841w" data-sizes="(max-width: 841px) 100vw, 841px" data-src="/assets/static/copilot-screenshot.e9949b5.34af4401cab333fbfbe74c40f515e559.jpeg"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/copilot-screenshot.e9949b5.34af4401cab333fbfbe74c40f515e559.jpeg" width="841" alt="Copilot workflow"></noscript></p>
<h2 id="introduction"><a href="#introduction" aria-hidden="true"><span class="icon icon-link"></span></a>Introduction</h2>
<p>In this article, I share an experimental approach to optimizing Django queries using an AI-assisted workflow. By combining <a href="https://code.visualstudio.com/docs/copilot/overview" target="_blank" rel="nofollow noopener noreferrer">VSCode Copilot</a>, Postgres <a href="https://code.visualstudio.com/docs/copilot/chat/mcp-servers" target="_blank" rel="nofollow noopener noreferrer">MCP server</a>, <a href="https://github.com/jazzband/django-silk" target="_blank" rel="nofollow noopener noreferrer">django-silk</a> and <a href="https://playwright.dev/python/" target="_blank" rel="nofollow noopener noreferrer">Playwright</a>, I was able to automate parts of the query analysis and optimization process. The results were promising, though the workflow had some notable limitations.</p>
<h2 id="problem"><a href="#problem" aria-hidden="true"><span class="icon icon-link"></span></a>Problem</h2>
<p>In a large Django application, I wanted to address inefficient queries, particularly N+1 problems, that could often be resolved with <a href="https://docs.djangoproject.com/en/5.2/ref/models/querysets/#select-related" target="_blank" rel="nofollow noopener noreferrer">select_related</a> or <a href="https://docs.djangoproject.com/en/5.2/ref/models/querysets/#prefetch-related" target="_blank" rel="nofollow noopener noreferrer">prefetch_related</a>. Given the size of the codebase, I explored whether an AI coding agent could help speed up the process.</p>
<p>Two main obstacles emerged:</p>
<ol>
<li>The AI needed a way to measure the number of queries executed</li>
<li>The AI needed a way to send authenticated requests to the application</li>
</ol>
<h2 id="solution"><a href="#solution" aria-hidden="true"><span class="icon icon-link"></span></a>Solution</h2>
<p><a href="https://github.com/jazzband/django-silk" target="_blank" rel="nofollow noopener noreferrer">Django-silk</a> records SQL queries in database tables whenever a webpage is requested. This makes it straightforward to spot N+1 issues through duplicate queries and to trace them back to the source code. Silk provides a web interface for manual analysis, but since the data is stored in Postgres, it can also be accessed programmatically.</p>
<p>By installing and configuring a Postgres MCP server in VSCode, Copilot gained access to these tables. This enabled the AI to analyze query performance directly from my local database, solving the first challenge of query measurement.</p>
<p>To configure a Postgres MCP server add the following to <code>~/.vscode/mcp.json</code> using your actual database url:</p>
<pre><code class="language-json">{
    "servers": {
        "postgres": {
            "command": "npx",
            "args": [
                "-y",
                "@modelcontextprotocol/server-postgres",
                "postgresql://user:pass@localhost:5432/mydb"
            ]
        }
    }
}
</code></pre>
<p>Then open the command palette and run "MCP: List servers", then select "postgres", then select "Start server". If the connection to your database is successful the output should say "Discovered 1 tools".</p>
<p>For the second challenge, I used <a href="https://playwright.dev/python/" target="_blank" rel="nofollow noopener noreferrer">Playwright</a> to automate browser interactions. The following script logs into the application and navigates to a specified page, allowing Copilot to trigger queries during the request/response cycle:</p>
<pre><code class="language-python"># request_page.py

import sys

from playwright.sync_api import sync_playwright

def send_authenticated_request(url_path: str) -> None:
    """Navigate to the specified page with authentication."""
    base_url = "&#x3C;http://localhost:8001>"
    full_url = f"{base_url}{url_path}"

    with sync_playwright() as p:
        browser = p.chromium.launch(headless=False)
        page = browser.new_page()

        page.goto(f"{base_url}/login/")
        page.wait_for_selector('input[name="username"]', timeout=10000)
        page.fill('input[name="username"]', "mitch.harle")
        page.click('button[type="submit"]')
        page.fill('input[name="password"]', "*******")
        page.click('button[type="submit"]')
        page.wait_for_url(f"{base_url}/", timeout=10000)

        page.goto(full_url)
        page.wait_for_url(full_url, timeout=10000)

if _name_ == "_main_":
    send_authenticated_request(sys.argv[1])
</code></pre>
<p>The following prompt can then be used to start the process in Copilot:</p>
<blockquote>
<p>I am attempting to perform Django query optimizations across my application. When I ask you to optimize queries on the url <code>/abc/</code> you should call the following script: <code>python3 request_page.py /abc/</code></p>
<p>If the script runs successfully please use the Postgres MCP server to query django-silk tables to measure the queries for this url. You should identify if there are any N+1 queries, this is usually identified by many duplicate queries. The 'SQLQuery' table has a field 'traceback' which will give you the code which executed the SQL query, use this to find where in the code query optimizations can be made. For now I am mostly focusing on fixing very inefficient queries, for example those that can be fixed with <code>select_related</code>/<code>prefetch_related</code>.</p>
<p>You should attempt to fix the code, then request the url again, then measure the queries again. If your code changes has reduced the number of queries keep the change, if not rollback the change and try a different approach.</p>
<p>Let's start with url <code>/abc/</code></p>
</blockquote>
<p>Copilot then performed the following iterative loop:</p>
<ol>
<li>Send an authenticated request to the target page</li>
<li>Analyze query execution data from Django-Silk</li>
<li>Modify the code to reduce queries</li>
</ol>
<p><img class="g-image g-image--lazy g-image--loading" src="data:image/svg+xml,%3csvg fill='none' viewBox='0 0 976 586' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-f0b37779e3b0420571bd81cbd6617a1c'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-f0b37779e3b0420571bd81cbd6617a1c)' width='976' height='586' xlink:href='data:image/png%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAmCAYAAAB0xJ2ZAAAACXBIWXMAABYlAAAWJQFJUiTwAAAMxElEQVR42t1ad3BU5xFXJhijDgKVUznpJCRAqJxOdzr1Uzm1k4R6F6CGqBJIIIFAYHo3hjEYJk7sIcEh/sMmCbYncWyHZEjBjmNjmyEODvJMnHEZUmzPpI2TX3b33TudhKRIIBgnf%2by8d9/73n777e5vv9195%2bIVkQxPnRkeoUmYl5SJQGsuggqsd0B5d/je/aFAIk12DubEpsEjJAmy73AzXHjzXvOTEVpdhNDKQgTQJP/MbARYiDInSTR3XroFfhlZ0GTlQGPJUa5EARaV3/Bvfi78idR5o%2bdrLMN8Aiw5jveV39lTk9E%2bj42rayiGhq4eWkUJLmz50KpCaHJy4B5ogjtpRyHTJMg%2bL9gEvwWZmKNLxQP%2bCXgwwEBXPWYGJGCWJhGeWjNmBSbKM9cgIx7UGOBGV1ca4zk8n68z/PQ03wCvULMyrjHYeRjkfb5ncgs2ihUnJ6OTrCQn7zestkgUyDxc5hkzRQHuQSbxBKGIyZH3/BS4hhoRZsxH745DSLY1IsZSgcWZZUgraabxApS3dCM2qwKa2Gyk0HNNbBYWppWibf0gajp6EWEugj63GjGZ5UgqrEdJ8xrkVrVDn1OFRelL5N282hXILFsucyKTbWhesxnzFmXAIzxpSvLyXM8wM7wXpkBXb1MgoMnNVawfoiiAByfNkIgVEG4qRNOqfnRv3Y/B/SfQv%2bsoqtt65NpKG03Mq4W1ugOPnDmLxpV9aO3ehs27H0b58i5s23ccgwdOoGf7QVS2rsemnUewcuNOrOh9CEX1K7Hz8En0DB7Elj3HsPvoY2jfsB2rNu1CQEwW3MNMU5JV9kZ7VL1%2bTkyaooAAwpUEhqlo007uuiT4LbYgu6IVxrw6pJcuk2tIghUGaw2yK9sQGJeDBLIyKyFjyTJk0Jz0kqXQGQvJ0tV2i1cj1JCP1OImeT%2b5qJHum%2bUd/s0elV66VOZllbfCO2LqxlK9gPHP8c4nPn1YAe53oABVAPewJLhqCdshBqJEzNImytgsvifyICXNCNQT3qLh4huDr/jHwcUvBjODKVbwuO9iGovFVzXxQsyHeTAvuQ9R7mfZefNVXXvKSlAVUDUNCnAWwHv%2bSFLHZlOccAs1CX4t5S1ItTUhLqtSvCAqpRhaQ554gym/HonWWpQ0rZE4whudHZkqcWY0bx7zulsPmC4FjCWI828JlOQdBbWdEhO2Eua7BvYJjlf37caytQM4cvIJdBLuB/Y%2bgnVb9oqC2Du8I1LGtfQdbf5eKWAswfjKwUa9D9bnUgQvRlJBAxalLUEDBUMLRfakgnqYiKLTy%2bgUaBC8axPyxGu8o1KUwKwz392m74cCWDhVQN443/NZK8/DkyViS5wgy86ik8M7Kg2uNPYA4XkmjfNpMjM4QSzPc3nTs6NTJUFz5v2lVYCzIvh4WdhViYjlpSP4ekemCK69gvTwoCDoRQHQOyiBiK60aW875h0nDL0bVEgpdlGeJDF3ckzffwWQ5TjV1O9poPwi1yG4F23MU8sZXCJ8y%2blo3HMcvo%2bdhc%2bR0/Bp3wTvxCJ4U%2bATHsJr2Jt0DTbMNWQ40te7UsK9hIAqsLaiUHL3OYvTFPyS5XnjXgYros89jegbN%2bD/yR/g9%2bktzPnjx/B85zp8nrwA98pVSnLDLm/ny/xYUF1TsSMWfOk8QM2w2NqcVYaUFSiptfqc08/4NDS99AIO3/wIgz97B7VXrsHnzd9A98a72PTmTez61U2suPgqQlv74U7xwOEJdr5czQUXTwMU7lUewJtki4c3F4/MD8j6XMyYetvwzaH3sff6Z6j/%2bS1sfeYaYk88h7qzP8Hp3/4Z665/iq6XP0THhSuYTTmDJ8PBKR44oJB4l1C4Vwpgplxl%2bZotioAqr3BKhHQG2E7lYOul6zB%2b%2bwMk7R3C2hOvo7DzJDoGn0LthSHEP3oTlp030f3sVUSs6oVbQLwERWdo%2bcSRghkKd3MqTKcCnF2f%2bwji%2bg4XVQKZW3AS/K1WVL0UgzWPX0Tm9t%2bhdff76Dt2Gc3rD6Kl/2tYf%2boqqgZuYOXA%2b2h58gfQ738EXgvTadOm29YJzGMo5N85FKZLAc6uz%2be1uL6zQJwCB%2buxeOkG2M6dRO0votB4uAN1XUfQuOVR7D/3Pbz3ycd46doQ1hx/HlUbn0BZz2lYj5%2bE5cx5FJw6C02ajYQ1jpBLoEClLJfxzlCYtCKmVQHMjN4LqyHXT7aMrCg5BQ6JQ96xJ1H%2brWOouzQfGy/0YtfFfTj2/Dfw4mu/xK2//RNDt/6Ep165jMMXX8bB88%2bh5uTjMG7dh7pnXkRMazdmBcRJHHFAgYosbmuxwp03fl8VMML16V1tecEYLklHnzYWMd2HYNw9gMZXwrHnh/vxo6G38f0330J13yl8%2bPlnePHX76J562lcHvo9zl16A5WHzyC6vRfxO85REtRCfPWOYDjitKFcI6Q0f%2bRpMxkl3K0CHBrnVHURu34JnfPJY57RnjoTwnKWIHFDNhquBGDvM0dx%2bcZHuPDaW2jf93XygL/j5avvovPAE3ju7SEcffYKCjY/jIjqHvimNlBGmUs8ksaUQ/INqun9M7Klw3NfPMB5EbYC5%2bl%2bqVkO1x/pjgp5hJgRmJGAtBMR6D6/Gd99%2bxou3fwAH/71H/j8i3/jL1/8C%2b99%2bjm%2b8/p7GDz/UyQ09MHXWC4b9wwfH%2bOscK414nbUITDfOvmgOB0QYAac8HDGN97Ccgo4jkjlRNAWmmEdWIa%2bp87g8R%2b/ghfeuoZnX72KA0%2b/gNrtxxFhbcLsBRniOf/NrXmcN7CopwqRK8ocLb174gFjaZ%2b1zhCYqFT1jDA7jkOuCN2CzXClis8tMgE%2bhnQEphbAz5hPv1OpSqTxEMOw1SOGFTheA0Ytt3kPXDrfZQxQNMjtK67FmRm3tZSOTMpwZ8be5ODFee7w2HADRKWRQisBTMYpOfKk9925OOK0l57LuPrOBFZXr1w%2bc1eYZfXSjVx7dOfae1QQHVMBjGNmOG9RJkITCzAnKhUBMdlKb45reLKOK90zSbuKnvssSJca342EcZU%2boElqerWPpzwzjfIQ83D7fZJteGfLstLn0rrzk0vgvzgLWpJ1RmC8yKDKyvdu3H/gsRBljGWZ0AM8Q814gOryjLJWtPXuRmHDWrRs2IWC%2bjUooPvCxnUob92I7KoVNKcN9au3Ij6nBuFJNhTRs2TbUhGqZOl65NWtxpLlPTAXNWNRRvntEAob7hZNteXGm2IDrew/ILKJrLS%2bmdZnmXntTCq3ozMrYCpshK25m%2bTuhSGvXt4V7x0PAvywmF6oaNuIpd0PoaylF539%2b7F8/U7UrtwCS0UHGtcOEm2TsYXpZbJJVhT/rmzvw7rBo2jt2SVC8G9WFiuWeattMo4dfulZjh49K2RcGpXosHWD4q2oWbEZzV3bsYzk7Ni0V%2bTq7NuPFlq7ed12NK7ZJldWyuqBQyK7KCByPAVQNGe39iUIsCuzlkMS8hCst0pff05UmnR4o1JKkVq6XDo7DBEWKrVkOSJTShBM8zWxOfIez01b0iLfDNydznJOmvR7GyR6cyLDZzmfJmMR1xazF6aOyDE87fGC3Z/JNzoTWkO%2bKEWVmeXle62hQOTgMZ7H8JkwBnDU5knuEgiNEpkZ2/wZihWh9PWUro1vtEV%2b81zGWUhCvr0DnIiZQQnER7Geh25k6crtMj5BeIM%2b%2bnRJayei2/MLOxQI0/I9wo5z9jKOPTM08cpnM/kWET8cn1QjTHQM8gY4eEQQrhlLebWrkFPdiQZyJ4YG45pJMF%2b8VOZYKtpR1dGHJnLBrMoOmZ9P4wwjDpIeTtaXhIbcmr1NdW/O7acCAeVDjEm8z0LrsVyRFHt4zdJlG8TlOWbx%2bvkUI3gsLrt6giBodVIANy9Ii/rcWsF/W%2b8eYVTRtgl1qwYkmLBbV6/ol9%2b2pi5Ud/QTBvfJGNOSlh5UEfZZsMD4XFHobXnC/Kn19kfP482EGQsl4PLatuYurNpyUGJRZfsmgej6HcdQ07lZYlNuzUrZl3LUjvo0xrm0dF25qIgcXiyEcMVRPjqjQizJm%2bErx4K5CzNEgAizTfDnH5OFIIIIux5/EVbnqIFvWtrZo4hdm08gs61ZZODYxTCVWEXxieMDf0Dlr9J8P8ITCZ5htTZ4L0iBC2dQ3GXhH%2bKa7KY0Qc5wrYIfdlM%2bz/nKjDzs3wJdCXtugkWT4zmPq3M87XHgXhBnlq52%2bdR4wEqRtXVmJT6F2kkarYpx3QKM8ocJDsby/wB2B67luarjJgPDQChqHJro2Rhz2avuFU1FRplPRuYaRjU4G8hFLW7mJqQLLuSvMv%2bnxI0bbqcJ1MMUaLo4Nx2lrJ1Is//jpJbxzifLfwBV6QlXoYCA2wAAAABJRU5ErkJggg==' /%3e%3c/svg%3e" width="976" alt="Copilot workflow" data-srcset="/assets/static/query-optimization-cycle.82a2fbd.cc57fe203efaa62861dd88c0cb6acee3.png 480w, /assets/static/query-optimization-cycle.f67bb29.cc57fe203efaa62861dd88c0cb6acee3.png 976w" data-sizes="(max-width: 976px) 100vw, 976px" data-src="/assets/static/query-optimization-cycle.f67bb29.cc57fe203efaa62861dd88c0cb6acee3.png"><noscript><img class="g-image g-image--lazy g-image--loaded" src="/assets/static/query-optimization-cycle.f67bb29.cc57fe203efaa62861dd88c0cb6acee3.png" width="976" alt="Copilot workflow"></noscript></p>
<p>This feedback loop with an explicit goal of reducing queries allowed it identify when it's changes have made a positive or negative impact. With some human oversight, this process successfully identified and resolved several inefficient queries.</p>
<h2 id="limitations"><a href="#limitations" aria-hidden="true"><span class="icon icon-link"></span></a>Limitations</h2>
<p>The limitations of this approach included:</p>
<ol>
<li>After each code change, the Django server needed to restart, sometimes causing requests to be sent prematurely. The Playwright script could be improved to handle this more reliably.</li>
<li>Each script execution required manual confirmation, I could not find a way to auto-approve these actions.</li>
<li>The script only supported GET requests. Optimizing queries behind POST requests or JavaScript interactions would require custom Playwright actions.</li>
<li>As always the code suggestions by Copilot were not perfect and needed human reviewing/editing.</li>
<li>At times, Copilot forgot how to call scripts and needed reminders.</li>
</ol>
<h2 id="conclusion"><a href="#conclusion" aria-hidden="true"><span class="icon icon-link"></span></a>Conclusion</h2>
<p>This experiment demonstrated that AI coding agents can meaningfully assist in query optimization workflows. While not fully autonomous, the combination of Copilot, Django-Silk, Postgres MCP server, and Playwright provided a practical, partially automated solution for identifying and resolving inefficient queries.</p>
<p>Future improvements could include adding more robust request handling, scripting additional guardrails, and automating approval steps to streamline the process further. Despite its limitations, setting up this workflow was quick and delivered tangible benefits, highlighting the evolving capabilities of AI-assisted development tools.</p>
</div><div class="mb-8"><a href="/blog" class="font-bold uppercase">Back to Blog</a></div></div></div><footer class="bg-green-700 text-white"><div class="container mx-auto flex flex-col lg:flex-row items-center justify-between py-8"><div class="mb-8 lg:mb-0"></div><ul class="flex items-center"><li class="mr-8"><a href="mailto:mitch104@protonmail.com" class="text-white hover:text-gray-400"><svg width="25" height="20" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M2.5 0h20A2.5 2.5 0 0 1 25 2.5v15a2.5 2.5 0 0 1-2.5 2.5h-20A2.5 2.5 0 0 1 0 17.5v-15C0 1.125 1.125 0 2.5 0zm20 4.225V2.5h-20v1.725l10 5 10-5zm0 2.8l-9.438 4.713a1.25 1.25 0 0 1-1.124 0L2.5 7.025V17.5h20V7.025z" fill-rule="nonzero"></path></svg></a></li><li class="mr-8"><a href="https://github.com/mitch104" target="_blank" class="text-white hover:text-gray-400"><svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"></path></svg></a></li><li><a href="https://www.linkedin.com/in/mitchellharle/?originalSubdomain=uk" target="_blank" class="text-white hover:text-gray-400"><svg width="24" height="24" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"></path></svg></a></li></ul></div></footer><div style="display:none"><svg id="dots-triangle" width="170" height="170" xmlns="http://www.w3.org/2000/svg"><path d="M168.152 170a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm-18.478-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm-18.478 0a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.479a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm-18.479 0a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0 18.479a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-55.435a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zM94.24 133.043a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0 18.479a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-55.435a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm-18.478 36.956a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0 18.479a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-55.435a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm-18.478 55.434a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0 18.479a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-55.435a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.479a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm-18.479 73.913a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0 18.479a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-55.435a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.479a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm-18.478 92.391a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0 18.479a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-55.435a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.479a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zM1.848 133.044a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.695zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0 18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-55.435a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.479a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.695 1.848 1.848 0 0 1 0 3.695zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696zm0-18.478a1.848 1.848 0 1 1 0-3.696 1.848 1.848 0 0 1 0 3.696z" fill="#2C8056" fill-rule="evenodd" opacity=".503"></path></svg></div></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"AI assisted workflow for Django query optimizations","date":"August 3, 2025","content":"\u003Cp\u003E\u003Cimg class=\"g-image g-image--lazy g-image--loading\" src=\"data:image\u002Fsvg+xml,%3csvg fill='none' viewBox='0 0 841 596' xmlns='http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg' xmlns:xlink='http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-21cf64648e150f10b1f707433b5a4193'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'\u002F%3e%3c\u002Ffilter%3e%3c\u002Fdefs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-21cf64648e150f10b1f707433b5a4193)' width='841' height='596' xlink:href='data:image\u002Fjpeg%3bbase64%2c\u002F9j\u002F2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj\u002F2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj\u002FwAARCAAtAEADASIAAhEBAxEB\u002F8QAGgAAAgMBAQAAAAAAAAAAAAAAAgQAAQMFB\u002F\u002FEADQQAAIBAwIDBQYEBwAAAAAAAAECAwAEERIhExQxBSJxkaEjQVFhktFSU2OBFTJDRGLw8f\u002FEABUBAQEAAAAAAAAAAAAAAAAAAAAB\u002F8QAFBEBAAAAAAAAAAAAAAAAAAAAAP\u002FaAAwDAQACEQMRAD8A8AtSsiYPIJpwMy5BNGHTc6OzdweoP3orZ7sxqGkuUjAAXTEWGP8AhrVpLgS9y6uyuNmNucn9qDBdJBAHZ23xHX1q1ZevD7O39xU7etXKk0yKs0l0yDcZgO1LvaMFHDSdj8DERRW%2bVIGE7OG34T8fGsblAQu9qMbex2z41kLac9IJT7v5D9qnLTn%2bhL9B%2b1EBoH4hU0Y31Cj5Wfb2Eu\u002FTuHf0quBIoLNHIADvlTgf7tQNW93KY1jM0MaqMAOmc%2bQNbSXcgfRzdmQvRwhx4dKYVSLBOFdziQw7KbiLSNtxjOobbY60pO1\u002FChkkulI6d2dWO\u002FyBzQXzshYlrm1wf0zgeAxQtfyxLlJrds42WPf1FL8\u002Fdn%2b4l6561Y7QvASRcygnqc0Gbzyu5YyOCTnutgftQ8WX82T6zQu7O7O5LMxySffQ0GnFk\u002FMk%2bs1YaRsDW5ycadROayq0JV1Kkgg7EUHW7PhCwZaG3kZgGUtPCMeIbJHpTM95b2sKxPZxktvlGgfx3Vdq59g8KwSl4FdxjBIUgeamn35QIGFqAc4OyfP\u002FAA%2bVAnNfWZRuFZ6XxhdQjIHiAm9KNdsUK8K2APvEKg%2beK699dRxW5MFrCCcDvxo2B9I3%2bdc7%2bIycbicvZaumOXXHlQI1Kca%2bdmLG3s8n9AUq7anLEKMnoowPKgGoOo8alQdR40H\u002F2Q==' \u002F%3e%3c\u002Fsvg%3e\" width=\"841\" alt=\"Copilot workflow\" data-srcset=\"\u002Fassets\u002Fstatic\u002Fcopilot-screenshot.82a2fbd.34af4401cab333fbfbe74c40f515e559.jpeg 480w, \u002Fassets\u002Fstatic\u002Fcopilot-screenshot.e9949b5.34af4401cab333fbfbe74c40f515e559.jpeg 841w\" data-sizes=\"(max-width: 841px) 100vw, 841px\" data-src=\"\u002Fassets\u002Fstatic\u002Fcopilot-screenshot.e9949b5.34af4401cab333fbfbe74c40f515e559.jpeg\"\u003E\u003Cnoscript\u003E\u003Cimg class=\"g-image g-image--lazy g-image--loaded\" src=\"\u002Fassets\u002Fstatic\u002Fcopilot-screenshot.e9949b5.34af4401cab333fbfbe74c40f515e559.jpeg\" width=\"841\" alt=\"Copilot workflow\"\u003E\u003C\u002Fnoscript\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"introduction\"\u003E\u003Ca href=\"#introduction\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EIntroduction\u003C\u002Fh2\u003E\n\u003Cp\u003EIn this article, I share an experimental approach to optimizing Django queries using an AI-assisted workflow. By combining \u003Ca href=\"https:\u002F\u002Fcode.visualstudio.com\u002Fdocs\u002Fcopilot\u002Foverview\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EVSCode Copilot\u003C\u002Fa\u003E, Postgres \u003Ca href=\"https:\u002F\u002Fcode.visualstudio.com\u002Fdocs\u002Fcopilot\u002Fchat\u002Fmcp-servers\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EMCP server\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjazzband\u002Fdjango-silk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Edjango-silk\u003C\u002Fa\u003E and \u003Ca href=\"https:\u002F\u002Fplaywright.dev\u002Fpython\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EPlaywright\u003C\u002Fa\u003E, I was able to automate parts of the query analysis and optimization process. The results were promising, though the workflow had some notable limitations.\u003C\u002Fp\u003E\n\u003Ch2 id=\"problem\"\u003E\u003Ca href=\"#problem\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EProblem\u003C\u002Fh2\u003E\n\u003Cp\u003EIn a large Django application, I wanted to address inefficient queries, particularly N+1 problems, that could often be resolved with \u003Ca href=\"https:\u002F\u002Fdocs.djangoproject.com\u002Fen\u002F5.2\u002Fref\u002Fmodels\u002Fquerysets\u002F#select-related\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eselect_related\u003C\u002Fa\u003E or \u003Ca href=\"https:\u002F\u002Fdocs.djangoproject.com\u002Fen\u002F5.2\u002Fref\u002Fmodels\u002Fquerysets\u002F#prefetch-related\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eprefetch_related\u003C\u002Fa\u003E. Given the size of the codebase, I explored whether an AI coding agent could help speed up the process.\u003C\u002Fp\u003E\n\u003Cp\u003ETwo main obstacles emerged:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003EThe AI needed a way to measure the number of queries executed\u003C\u002Fli\u003E\n\u003Cli\u003EThe AI needed a way to send authenticated requests to the application\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch2 id=\"solution\"\u003E\u003Ca href=\"#solution\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESolution\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fjazzband\u002Fdjango-silk\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EDjango-silk\u003C\u002Fa\u003E records SQL queries in database tables whenever a webpage is requested. This makes it straightforward to spot N+1 issues through duplicate queries and to trace them back to the source code. Silk provides a web interface for manual analysis, but since the data is stored in Postgres, it can also be accessed programmatically.\u003C\u002Fp\u003E\n\u003Cp\u003EBy installing and configuring a Postgres MCP server in VSCode, Copilot gained access to these tables. This enabled the AI to analyze query performance directly from my local database, solving the first challenge of query measurement.\u003C\u002Fp\u003E\n\u003Cp\u003ETo configure a Postgres MCP server add the following to \u003Ccode\u003E~\u002F.vscode\u002Fmcp.json\u003C\u002Fcode\u003E using your actual database url:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-json\"\u003E{\n    \"servers\": {\n        \"postgres\": {\n            \"command\": \"npx\",\n            \"args\": [\n                \"-y\",\n                \"@modelcontextprotocol\u002Fserver-postgres\",\n                \"postgresql:\u002F\u002Fuser:pass@localhost:5432\u002Fmydb\"\n            ]\n        }\n    }\n}\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThen open the command palette and run \"MCP: List servers\", then select \"postgres\", then select \"Start server\". If the connection to your database is successful the output should say \"Discovered 1 tools\".\u003C\u002Fp\u003E\n\u003Cp\u003EFor the second challenge, I used \u003Ca href=\"https:\u002F\u002Fplaywright.dev\u002Fpython\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EPlaywright\u003C\u002Fa\u003E to automate browser interactions. The following script logs into the application and navigates to a specified page, allowing Copilot to trigger queries during the request\u002Fresponse cycle:\u003C\u002Fp\u003E\n\u003Cpre\u003E\u003Ccode class=\"language-python\"\u003E# request_page.py\n\nimport sys\n\nfrom playwright.sync_api import sync_playwright\n\ndef send_authenticated_request(url_path: str) -\u003E None:\n    \"\"\"Navigate to the specified page with authentication.\"\"\"\n    base_url = \"&#x3C;http:\u002F\u002Flocalhost:8001\u003E\"\n    full_url = f\"{base_url}{url_path}\"\n\n    with sync_playwright() as p:\n        browser = p.chromium.launch(headless=False)\n        page = browser.new_page()\n\n        page.goto(f\"{base_url}\u002Flogin\u002F\")\n        page.wait_for_selector('input[name=\"username\"]', timeout=10000)\n        page.fill('input[name=\"username\"]', \"mitch.harle\")\n        page.click('button[type=\"submit\"]')\n        page.fill('input[name=\"password\"]', \"*******\")\n        page.click('button[type=\"submit\"]')\n        page.wait_for_url(f\"{base_url}\u002F\", timeout=10000)\n\n        page.goto(full_url)\n        page.wait_for_url(full_url, timeout=10000)\n\nif _name_ == \"_main_\":\n    send_authenticated_request(sys.argv[1])\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EThe following prompt can then be used to start the process in Copilot:\u003C\u002Fp\u003E\n\u003Cblockquote\u003E\n\u003Cp\u003EI am attempting to perform Django query optimizations across my application. When I ask you to optimize queries on the url \u003Ccode\u003E\u002Fabc\u002F\u003C\u002Fcode\u003E you should call the following script: \u003Ccode\u003Epython3 request_page.py \u002Fabc\u002F\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EIf the script runs successfully please use the Postgres MCP server to query django-silk tables to measure the queries for this url. You should identify if there are any N+1 queries, this is usually identified by many duplicate queries. The 'SQLQuery' table has a field 'traceback' which will give you the code which executed the SQL query, use this to find where in the code query optimizations can be made. For now I am mostly focusing on fixing very inefficient queries, for example those that can be fixed with \u003Ccode\u003Eselect_related\u003C\u002Fcode\u003E\u002F\u003Ccode\u003Eprefetch_related\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EYou should attempt to fix the code, then request the url again, then measure the queries again. If your code changes has reduced the number of queries keep the change, if not rollback the change and try a different approach.\u003C\u002Fp\u003E\n\u003Cp\u003ELet's start with url \u003Ccode\u003E\u002Fabc\u002F\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003C\u002Fblockquote\u003E\n\u003Cp\u003ECopilot then performed the following iterative loop:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003ESend an authenticated request to the target page\u003C\u002Fli\u003E\n\u003Cli\u003EAnalyze query execution data from Django-Silk\u003C\u002Fli\u003E\n\u003Cli\u003EModify the code to reduce queries\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Cp\u003E\u003Cimg class=\"g-image g-image--lazy g-image--loading\" src=\"data:image\u002Fsvg+xml,%3csvg fill='none' viewBox='0 0 976 586' xmlns='http:\u002F\u002Fwww.w3.org\u002F2000\u002Fsvg' xmlns:xlink='http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-f0b37779e3b0420571bd81cbd6617a1c'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'\u002F%3e%3c\u002Ffilter%3e%3c\u002Fdefs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-f0b37779e3b0420571bd81cbd6617a1c)' width='976' height='586' xlink:href='data:image\u002Fpng%3bbase64%2ciVBORw0KGgoAAAANSUhEUgAAAEAAAAAmCAYAAAB0xJ2ZAAAACXBIWXMAABYlAAAWJQFJUiTwAAAMxElEQVR42t1ad3BU5xFXJhijDgKVUznpJCRAqJxOdzr1Uzm1k4R6F6CGqBJIIIFAYHo3hjEYJk7sIcEh\u002FsMmCbYncWyHZEjBjmNjmyEODvJMnHEZUmzPpI2TX3b33TudhKRIIBgnf%2by8d9\u002F73n777e5vv9195%2bIVkQxPnRkeoUmYl5SJQGsuggqsd0B5d\u002Fje\u002FaFAIk12DubEpsEjJAmy73AzXHjzXvOTEVpdhNDKQgTQJP\u002FMbARYiDInSTR3XroFfhlZ0GTlQGPJUa5EARaV3\u002FBvfi78idR5o%2bdrLMN8Aiw5jveV39lTk9E%2bj42rayiGhq4eWkUJLmz50KpCaHJy4B5ogjtpRyHTJMg%2bL9gEvwWZmKNLxQP%2bCXgwwEBXPWYGJGCWJhGeWjNmBSbKM9cgIx7UGOBGV1ca4zk8n68z\u002FPQ03wCvULMyrjHYeRjkfb5ncgs2ihUnJ6OTrCQn7zestkgUyDxc5hkzRQHuQSbxBKGIyZH3\u002FBS4hhoRZsxH745DSLY1IsZSgcWZZUgraabxApS3dCM2qwKa2Gyk0HNNbBYWppWibf0gajp6EWEugj63GjGZ5UgqrEdJ8xrkVrVDn1OFRelL5N282hXILFsucyKTbWhesxnzFmXAIzxpSvLyXM8wM7wXpkBXb1MgoMnNVawfoiiAByfNkIgVEG4qRNOqfnRv3Y\u002FB\u002FSfQv%2bsoqtt65NpKG03Mq4W1ugOPnDmLxpV9aO3ehs27H0b58i5s23ccgwdOoGf7QVS2rsemnUewcuNOrOh9CEX1K7Hz8En0DB7Elj3HsPvoY2jfsB2rNu1CQEwW3MNMU5JV9kZ7VL1%2bTkyaooAAwpUEhqlo007uuiT4LbYgu6IVxrw6pJcuk2tIghUGaw2yK9sQGJeDBLIyKyFjyTJk0Jz0kqXQGQvJ0tV2i1cj1JCP1OImeT%2b5qJHum%2bUd\u002Fs0elV66VOZllbfCO2LqxlK9gPHP8c4nPn1YAe53oABVAPewJLhqCdshBqJEzNImytgsvifyICXNCNQT3qLh4huDr\u002FjHwcUvBjODKVbwuO9iGovFVzXxQsyHeTAvuQ9R7mfZefNVXXvKSlAVUDUNCnAWwHv%2bSFLHZlOccAs1CX4t5S1ItTUhLqtSvCAqpRhaQ554gym\u002FHonWWpQ0rZE4whudHZkqcWY0bx7zulsPmC4FjCWI828JlOQdBbWdEhO2Eua7BvYJjlf37caytQM4cvIJdBLuB\u002FY%2bgnVb9oqC2Du8I1LGtfQdbf5eKWAswfjKwUa9D9bnUgQvRlJBAxalLUEDBUMLRfakgnqYiKLTy%2bgUaBC8axPyxGu8o1KUwKwz392m74cCWDhVQN443\u002FNZK8\u002FDkyViS5wgy86ik8M7Kg2uNPYA4XkmjfNpMjM4QSzPc3nTs6NTJUFz5v2lVYCzIvh4WdhViYjlpSP4ekemCK69gvTwoCDoRQHQOyiBiK60aW875h0nDL0bVEgpdlGeJDF3ckzffwWQ5TjV1O9poPwi1yG4F23MU8sZXCJ8y%2blo3HMcvo%2bdhc%2bR0\u002FBp3wTvxCJ4U%2bATHsJr2Jt0DTbMNWQ40te7UsK9hIAqsLaiUHL3OYvTFPyS5XnjXgYros89jegbN%2bD\u002FyR\u002Fg9%2bktzPnjx\u002FB85zp8nrwA98pVSnLDLm\u002Fny\u002FxYUF1TsSMWfOk8QM2w2NqcVYaUFSiptfqc08\u002F4NDS99AIO3\u002FwIgz97B7VXrsHnzd9A98a72PTmTez61U2suPgqQlv74U7xwOEJdr5czQUXTwMU7lUewJtki4c3F4\u002FMD8j6XMyYetvwzaH3sff6Z6j\u002F%2bS1sfeYaYk88h7qzP8Hp3\u002F4Z665\u002Fiq6XP0THhSuYTTmDJ8PBKR44oJB4l1C4Vwpgplxl%2bZotioAqr3BKhHQG2E7lYOul6zB%2b%2bwMk7R3C2hOvo7DzJDoGn0LthSHEP3oTlp030f3sVUSs6oVbQLwERWdo%2bcSRghkKd3MqTKcCnF2f%2bwji%2bg4XVQKZW3AS\u002FK1WVL0UgzWPX0Tm9t%2bhdff76Dt2Gc3rD6Kl\u002F2tYf%2boqqgZuYOXA%2b2h58gfQ738EXgvTadOm29YJzGMo5N85FKZLAc6uz%2be1uL6zQJwCB%2buxeOkG2M6dRO0votB4uAN1XUfQuOVR7D\u002F3Pbz3ycd46doQ1hx\u002FHlUbn0BZz2lYj5%2bE5cx5FJw6C02ajYQ1jpBLoEClLJfxzlCYtCKmVQHMjN4LqyHXT7aMrCg5BQ6JQ96xJ1H%2brWOouzQfGy\u002F0YtfFfTj2\u002FDfw4mu\u002FxK2\u002F\u002FRNDt\u002F6Ep165jMMXX8bB88%2bh5uTjMG7dh7pnXkRMazdmBcRJHHFAgYosbmuxwp03fl8VMML16V1tecEYLklHnzYWMd2HYNw9gMZXwrHnh\u002Fvxo6G38f0330J13yl8%2bPlnePHX76J562lcHvo9zl16A5WHzyC6vRfxO85REtRCfPWOYDjitKFcI6Q0f%2bRpMxkl3K0CHBrnVHURu34JnfPJY57RnjoTwnKWIHFDNhquBGDvM0dx%2bcZHuPDaW2jf93XygL\u002Fj5avvovPAE3ju7SEcffYKCjY\u002FjIjqHvimNlBGmUs8ksaUQ\u002FINqun9M7Klw3NfPMB5EbYC5%2bl%2bqVkO1x\u002Fpjgp5hJgRmJGAtBMR6D6\u002FGd99%2bxou3fwAH\u002F71H\u002Fj8i3\u002FjL1\u002F8C%2b99%2bjm%2b8\u002Fp7GDz\u002FUyQ09MHXWC4b9wwfH%2bOscK414nbUITDfOvmgOB0QYAac8HDGN97Ccgo4jkjlRNAWmmEdWIa%2bp87g8R%2b\u002FghfeuoZnX72KA0%2b\u002FgNrtxxFhbcLsBRniOf\u002FNrXmcN7CopwqRK8ocLb174gFjaZ%2b1zhCYqFT1jDA7jkOuCN2CzXClis8tMgE%2bhnQEphbAz5hPv1OpSqTxEMOw1SOGFTheA0Ytt3kPXDrfZQxQNMjtK67FmRm3tZSOTMpwZ8be5ODFee7w2HADRKWRQisBTMYpOfKk9925OOK0l57LuPrOBFZXr1w%2bc1eYZfXSjVx7dOfae1QQHVMBjGNmOG9RJkITCzAnKhUBMdlKb45reLKOK90zSbuKnvssSJca342EcZU%2boElqerWPpzwzjfIQ83D7fZJteGfLstLn0rrzk0vgvzgLWpJ1RmC8yKDKyvdu3H\u002FgsRBljGWZ0AM8Q814gOryjLJWtPXuRmHDWrRs2IWC%2bjUooPvCxnUob92I7KoVNKcN9au3Ij6nBuFJNhTRs2TbUhGqZOl65NWtxpLlPTAXNWNRRvntEAob7hZNteXGm2IDrew\u002FILKJrLS%2bmdZnmXntTCq3ozMrYCpshK25m%2bTuhSGvXt4V7x0PAvywmF6oaNuIpd0PoaylF539%2b7F8\u002FU7UrtwCS0UHGtcOEm2TsYXpZbJJVhT\u002Frmzvw7rBo2jt2SVC8G9WFiuWeattMo4dfulZjh49K2RcGpXosHWD4q2oWbEZzV3bsYzk7Ni0V%2bTq7NuPFlq7ed12NK7ZJldWyuqBQyK7KCByPAVQNGe39iUIsCuzlkMS8hCst0pff05UmnR4o1JKkVq6XDo7DBEWKrVkOSJTShBM8zWxOfIez01b0iLfDNydznJOmvR7GyR6cyLDZzmfJmMR1xazF6aOyDE87fGC3Z\u002FJNzoTWkO%2bKEWVmeXle62hQOTgMZ7H8JkwBnDU5knuEgiNEpkZ2\u002FwZihWh9PWUro1vtEV%2b81zGWUhCvr0DnIiZQQnER7Geh25k6crtMj5BeIM%2b%2bnRJayei2\u002FMLOxQI0\u002FI9wo5z9jKOPTM08cpnM\u002FkWET8cn1QjTHQM8gY4eEQQrhlLebWrkFPdiQZyJ4YG45pJMF%2b8VOZYKtpR1dGHJnLBrMoOmZ9P4wwjDpIeTtaXhIbcmr1NdW\u002FO7acCAeVDjEm8z0LrsVyRFHt4zdJlG8TlOWbx%2bvkUI3gsLrt6giBodVIANy9Ii\u002FrcWsF\u002FW%2b8eYVTRtgl1qwYkmLBbV6\u002Fol9%2b2pi5Ud\u002FQTBvfJGNOSlh5UEfZZsMD4XFHobXnC\u002FKn19kfP482EGQsl4PLatuYurNpyUGJRZfsmgej6HcdQ07lZYlNuzUrZl3LUjvo0xrm0dF25qIgcXiyEcMVRPjqjQizJm%2bErx4K5CzNEgAizTfDnH5OFIIIIux5\u002FEVbnqIFvWtrZo4hdm08gs61ZZODYxTCVWEXxieMDf0Dlr9J8P8ITCZ5htTZ4L0iBC2dQ3GXhH%2bKa7KY0Qc5wrYIfdlM%2bz\u002FnKjDzs3wJdCXtugkWT4zmPq3M87XHgXhBnlq52%2bdR4wEqRtXVmJT6F2kkarYpx3QKM8ocJDsby\u002FwB2B67luarjJgPDQChqHJro2Rhz2avuFU1FRplPRuYaRjU4G8hFLW7mJqQLLuSvMv%2bnxI0bbqcJ1MMUaLo4Nx2lrJ1Is\u002F\u002FjpJbxzifLfwBV6QlXoYCA2wAAAABJRU5ErkJggg==' \u002F%3e%3c\u002Fsvg%3e\" width=\"976\" alt=\"Copilot workflow\" data-srcset=\"\u002Fassets\u002Fstatic\u002Fquery-optimization-cycle.82a2fbd.cc57fe203efaa62861dd88c0cb6acee3.png 480w, \u002Fassets\u002Fstatic\u002Fquery-optimization-cycle.f67bb29.cc57fe203efaa62861dd88c0cb6acee3.png 976w\" data-sizes=\"(max-width: 976px) 100vw, 976px\" data-src=\"\u002Fassets\u002Fstatic\u002Fquery-optimization-cycle.f67bb29.cc57fe203efaa62861dd88c0cb6acee3.png\"\u003E\u003Cnoscript\u003E\u003Cimg class=\"g-image g-image--lazy g-image--loaded\" src=\"\u002Fassets\u002Fstatic\u002Fquery-optimization-cycle.f67bb29.cc57fe203efaa62861dd88c0cb6acee3.png\" width=\"976\" alt=\"Copilot workflow\"\u003E\u003C\u002Fnoscript\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EThis feedback loop with an explicit goal of reducing queries allowed it identify when it's changes have made a positive or negative impact. With some human oversight, this process successfully identified and resolved several inefficient queries.\u003C\u002Fp\u003E\n\u003Ch2 id=\"limitations\"\u003E\u003Ca href=\"#limitations\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ELimitations\u003C\u002Fh2\u003E\n\u003Cp\u003EThe limitations of this approach included:\u003C\u002Fp\u003E\n\u003Col\u003E\n\u003Cli\u003EAfter each code change, the Django server needed to restart, sometimes causing requests to be sent prematurely. The Playwright script could be improved to handle this more reliably.\u003C\u002Fli\u003E\n\u003Cli\u003EEach script execution required manual confirmation, I could not find a way to auto-approve these actions.\u003C\u002Fli\u003E\n\u003Cli\u003EThe script only supported GET requests. Optimizing queries behind POST requests or JavaScript interactions would require custom Playwright actions.\u003C\u002Fli\u003E\n\u003Cli\u003EAs always the code suggestions by Copilot were not perfect and needed human reviewing\u002Fediting.\u003C\u002Fli\u003E\n\u003Cli\u003EAt times, Copilot forgot how to call scripts and needed reminders.\u003C\u002Fli\u003E\n\u003C\u002Fol\u003E\n\u003Ch2 id=\"conclusion\"\u003E\u003Ca href=\"#conclusion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConclusion\u003C\u002Fh2\u003E\n\u003Cp\u003EThis experiment demonstrated that AI coding agents can meaningfully assist in query optimization workflows. While not fully autonomous, the combination of Copilot, Django-Silk, Postgres MCP server, and Playwright provided a practical, partially automated solution for identifying and resolving inefficient queries.\u003C\u002Fp\u003E\n\u003Cp\u003EFuture improvements could include adding more robust request handling, scripting additional guardrails, and automating approval steps to streamline the process further. Despite its limitations, setting up this workflow was quick and delivered tangible benefits, highlighting the evolving capabilities of AI-assisted development tools.\u003C\u002Fp\u003E\n","tags":[{"title":"Copilot","path":"\u002Ftag\u002FCopilot\u002F"},{"title":"Django","path":"\u002Ftag\u002FDjango\u002F"},{"title":"Django-silk","path":"\u002Ftag\u002FDjango-silk\u002F"},{"title":"Playwright","path":"\u002Ftag\u002FPlaywright\u002F"},{"title":"AI","path":"\u002Ftag\u002FAI\u002F"},{"title":"LLMs","path":"\u002Ftag\u002FLLMs\u002F"}]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.af93443e.js" defer></script><script src="/assets/js/page--src--templates--post-vue.09d095cc.js" defer></script>
  </body>
</html>
